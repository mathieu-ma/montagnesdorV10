<%@ page language="java" contentType="application/x-csv; charset=ISO-8859-1"%><%@ taglib uri="/WEB-INF/c.tld" prefix="c" %><%@ taglib uri="/WEB-INF/fmt.tld" prefix="fmt" %><%@ taglib uri="/WEB-INF/fn.tld" prefix="fn" %><c:set var="day"><c:if test="${param.day!='-1'}"><fmt:formatNumber pattern="00" value="${param.day}"/></c:if></c:set><c:set var="month"><c:if test="${param.month!='-1'}"><fmt:formatNumber pattern="00" value="${param.month+1}"/></c:if></c:set><c:set var="year"><c:if test="${param.year!='-1'}"><c:out value="${param.year}"/></c:if></c:set><c:set var="filename" scope="page"><fmt:message key="statsConsumptionProductsListIFrame.jsp.file.backup"/>_<c:out value="${day}"/>_<c:out value="${month}"/>_<c:out value="${year}"/></c:set><jsp:scriptlet>String filename = (String)pageContext.getAttribute("filename");response.setHeader("Content-Disposition", "attachment; filename="+filename+".csv");</jsp:scriptlet><c:set var="numberStatsConsumptionProducts" value="0"/><c:set var="quantities" value="0"/><c:set var="prices" value="0"/><fmt:message key="statsConsumptionProductsListIFrame.jsp.label.quantity"/>;<fmt:message key="statsConsumptionProductsListIFrame.jsp.label.code"/>;<fmt:message key="statsConsumptionProductsListIFrame.jsp.label.label"/>;<fmt:message key="statsConsumptionProductsListIFrame.jsp.label.price"/>
<c:forEach var="statsConsumptionProduct" items="${statsConsumptionProductsList}" varStatus="status"><c:if test="${status.last}"><c:set var="numberStatsConsumptionProducts" value="${status.index+1}"/></c:if><c:set var="quantities" value="${quantities+statsConsumptionProduct.quantity}"/><c:set var="prices" value="${prices+statsConsumptionProduct.product.price}"/><fmt:formatNumber pattern="0.00" var="quantity" value="${statsConsumptionProduct.quantity}"/><c:out value="${fn:replace(quantity, ',', '.')}" />;<c:out value="${statsConsumptionProduct.product.id}"/>;<c:if test="${not empty statsConsumptionProduct.product.labels}"><c:out value="${statsConsumptionProduct.product.labels[sessionScope.userSession.currentLanguage]}"/></c:if><c:if test="${empty statsConsumptionProduct.product.labels}"><fmt:message key="statsConsumptionProductsListIFrame.jsp.label.product.deleted"/></c:if>;<fmt:formatNumber pattern="0.00" var="price" value="${statsConsumptionProduct.product.price}"/><c:out value="${fn:replace(price, ',', '.')}"/>
</c:forEach>	
